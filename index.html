<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vote na PrÃ³xima MÃºsica</title>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  background: #111;
  color: white;
  text-align: center;
  padding: 20px;
}
.categoria { margin-top: 30px; }
button {
  display: block;
  margin: 6px auto;
  padding: 10px;
  width: 95%;
  max-width: 500px;
  border: none;
  border-radius: 8px;
  background: #1db954;
  color: white;
  font-size: 14px;
  cursor: pointer;
}
button:disabled {
  background: gray;
  cursor: not-allowed;
}
#ranking {
  margin-top: 40px;
  text-align: left;
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
}
#timer {
  margin-top: 15px;
  font-size: 18px;
  color: yellow;
}
#status {
  margin-top: 10px;
  font-size: 14px;
  color: red;
}
</style>
</head>
<body>

<h1>ğŸµ Vote na prÃ³xima mÃºsica</h1>

<div id="timer"></div>
<div id="status"></div>
<div id="musicas"></div>

<h2>ğŸ”¥ Ranking ao vivo</h2>
<div id="ranking"></div>

<script>

const firebaseConfig = {
  apiKey: "COLE_AQUI",
  authDomain: "COLE_AQUI",
  databaseURL: "COLE_AQUI",
  projectId: "COLE_AQUI",
  storageBucket: "COLE_AQUI",
  messagingSenderId: "COLE_AQUI",
  appId: "COLE_AQUI"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

const statusDiv = document.getElementById("status");
const timerDiv = document.getElementById("timer");
const musicasDiv = document.getElementById("musicas");
const rankingDiv = document.getElementById("ranking");

let bloqueado = false;
let tempoRestante = 5;

const categorias = {

"Rock Nacional": [
"Os Paralamas do Sucesso â€“ Meu Erro",
"Skank â€“ Garota Nacional",
"Skank â€“ Sutilmente",
"LobÃ£o â€“ Me Chama",
"LobÃ£o â€“ BlÃ¡, BlÃ¡, BlÃ¡... Eu Te Amo",
"LobÃ£o â€“ RÃ¡dio BlÃ¡",
"BarÃ£o Vermelho â€“ Bete BalanÃ§o",
"Frejat â€“ Segredos",
"LegiÃ£o Urbana â€“ Pais E Filhos",
"Cazuza â€“ Exagerado",
"TitÃ£s â€“ Pra Dizer Adeus",
"Djavan â€“ LilÃ¡s"
],

"Grunge / Alternativo": [
"Nirvana â€“ Smells Like Teen Spirit",
"Nirvana â€“ Come As You Are",
"Nirvana â€“ Heart-Shaped Box",
"Nirvana â€“ About A Girl",
"Nirvana â€“ Drain You",
"Pearl Jam â€“ Soldier of Love",
"Pearl Jam â€“ Last Kiss",
"Pearl Jam â€“ Black",
"Alice In Chains â€“ Man In The Box",
"Alice In Chains â€“ Would?",
"Alice In Chains â€“ Down In A Hole",
"Stone Temple Pilots â€“ Plush",
"Stone Temple Pilots â€“ Interstate Love Song",
"Stone Temple Pilots â€“ Creep",
"Radiohead â€“ Creep",
"Green Day â€“ American Idiot",
"The Smashing Pumpkins â€“ 1979",
"Queens of the Stone Age â€“ No One Knows",
"Queens of the Stone Age â€“ Make It Wit Chu",
"The White Stripes â€“ Seven Nation Army",
"Blur â€“ Coffee & TV",
"Oasis â€“ Wonderwall",
"Kings of Leon â€“ Closer"
],

"ClÃ¡ssicos Rock": [
"The Beatles â€“ Come Together",
"The Beatles â€“ Hey Jude",
"The Beatles â€“ Let It Be",
"Queen â€“ Another One Bites The Dust",
"Pink Floyd â€“ Wish You Were Here",
"Led Zeppelin â€“ Immigrant Song",
"Led Zeppelin â€“ Rock And Roll",
"Black Sabbath â€“ Paranoid",
"The Doors â€“ Roadhouse Blues",
"The Doors â€“ Love Me Two Times",
"The Doors â€“ Riders On The Storm",
"The Rolling Stones â€“ Anybody Seen My Baby?",
"Cream â€“ White Room",
"Cream â€“ Sunshine Of Your Love",
"Eric Clapton â€“ Cocaine",
"Lynyrd Skynyrd â€“ Sweet Home Alabama",
"Lynyrd Skynyrd â€“ Simple Man",
"Creedence Clearwater Revival â€“ Proud Mary",
"Creedence Clearwater Revival â€“ Have You Ever Seen The Rain",
"Creedence Clearwater Revival â€“ Suzie Q",
"Creedence Clearwater Revival â€“ Born On The Bayou",
"Creedence Clearwater Revival â€“ Bad Moon Rising",
"Creedence Clearwater Revival â€“ Fortunate Son",
"Survivor â€“ Eye Of The Tiger",
"Foghat â€“ Slow Ride",
"Tom Petty â€“ Runnin' Down A Dream"
],

"Pop / Outros": [
"Tim Maia â€“ Gostava Tanto de VocÃª",
"Tim Maia â€“ Primavera (Vai Chuva)",
"Elvis Presley â€“ Suspicious Minds",
"Ben E. King â€“ Stand By Me",
"U2 â€“ With Or Without You",
"U2 â€“ Helter Skelter",
"Commodores â€“ Easy",
"Tears For Fears â€“ Everybody Wants To Rule The World",
"Daft Punk â€“ Get Lucky",
"The Police â€“ Roxanne",
"The Police â€“ Every Breath You Take",
"INXS â€“ Never Tear Us Apart",
"INXS â€“ Need You Tonight",
"Chris Isaak â€“ Wicked Game",
"Billy Idol â€“ White Wedding",
"Phil Collins â€“ I Don't Care Anymore",
"Foreigner â€“ I Want To Know What Love Is",
"The Outfield â€“ Your Love",
"Modjo â€“ Lady",
"Jimmy Cliff â€“ I Can See Clearly Now",
"Mike + The Mechanics â€“ Over My Shoulder",
"Sugar Ray â€“ Every Morning",
"Spin Doctors â€“ Two Princes",
"Lenny Kravitz â€“ It Ain't Over 'Til It's Over",
"Lenny Kravitz â€“ Fly Away",
"Maroon 5 â€“ Sugar"
]

};

for (let categoria in categorias) {
  const div = document.createElement("div");
  div.className = "categoria";
  div.innerHTML = `<h3>${categoria}</h3>`;

  categorias[categoria].forEach(musica => {
    const btn = document.createElement("button");
    btn.innerText = musica;
    btn.onclick = () => votar(musica);
    div.appendChild(btn);
  });

  musicasDiv.appendChild(div);
}

function votar(musica) {
  if (bloqueado) return;

  bloqueado = true;
  statusDiv.innerText = "Salvando voto...";

  const ref = database.ref("ranking").child(musica);

  ref.transaction(current => (current || 0) + 1)
    .then(() => {
      statusDiv.innerText = "Voto salvo!";
      iniciarTimer();
    })
    .catch(error => {
      statusDiv.innerText = "Erro: " + error.message;
      bloqueado = false;
    });
}

function iniciarTimer() {
  tempoRestante = 5;
  timerDiv.innerText = `â³ Aguarde ${tempoRestante}s`;

  const intervalo = setInterval(() => {
    tempoRestante--;
    timerDiv.innerText = `â³ Aguarde ${tempoRestante}s`;

    if (tempoRestante <= 0) {
      clearInterval(intervalo);
      bloqueado = false;
      timerDiv.innerText = "";
      statusDiv.innerText = "";
    }
  }, 1000);
}

database.ref("ranking").on("value", snapshot => {
  const dados = snapshot.val() || {};
  rankingDiv.innerHTML = "";

  const ordenado = Object.entries(dados)
    .sort((a,b) => b[1] - a[1]);

  ordenado.forEach(item => {
    const p = document.createElement("p");
    p.innerText = `${item[0]} â€” ${item[1]} votos`;
    rankingDiv.appendChild(p);
  });
});

</script>
</body>
</html>
