<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Totem Profissional</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:black;
  color:white;
  text-align:center;
}

button{
  padding:20px;
  font-size:18px;
  border:none;
  border-radius:12px;
  background:#e10600;
  color:white;
  margin:10px;
  width:80%;
  max-width:300px;
}

button:active{
  background:#ff3b30;
}

#confirmScreen, #rankingScreen{
  display:none;
  padding:20px;
}

.big{
  font-size:26px;
  margin:20px 0;
}

.rankItem{
  font-size:22px;
  margin:10px 0;
}
</style>
</head>

<body>

<div id="voteScreen">
  <h1>Escolha a próxima música</h1>
  <div id="musicButtons"></div>
  <button onclick="showRanking()">Ver Ranking ao Vivo</button>
</div>

<div id="confirmScreen">
  <div class="big">Confirmar voto?</div>
  <div id="selectedMusic" class="big"></div>
  <button onclick="confirmVote()">Confirmar</button>
  <button onclick="cancelVote()">Cancelar</button>
</div>

<div id="rankingScreen">
  <h2>Ranking de votos</h2>
  <div id="rankingList"></div>
  <button onclick="backToVote()">Voltar</button>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCxpYTjgDElVqhhG-OUXJGIWXapifaZ9Zw",
  authDomain: "totem-12c8a.firebaseapp.com",
  databaseURL: "https://totem-12c8a-default-rtdb.firebaseio.com",
  projectId: "totem-12c8a",
  storageBucket: "totem-12c8a.appspot.com",
  messagingSenderId: "308642629645",
  appId: "1:308642629645:web:dfa6a4ce6dd85de4bced44"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

const musicas = [
  "Música 1",
  "Música 2",
  "Música 3",
  "Música 4",
  "Música 5",
  "Música 6"
];

let musicaSelecionada = null;

// Criar botões dinamicamente
const container = document.getElementById("musicButtons");
musicas.forEach(musica => {
  const btn = document.createElement("button");
  btn.innerText = musica;
  btn.onclick = () => selectMusic(musica);
  container.appendChild(btn);
});

function selectMusic(musica){
  musicaSelecionada = musica;
  document.getElementById("selectedMusic").innerText = musica;
  document.getElementById("voteScreen").style.display = "none";
  document.getElementById("confirmScreen").style.display = "block";
}

function cancelVote(){
  musicaSelecionada = null;
  document.getElementById("confirmScreen").style.display = "none";
  document.getElementById("voteScreen").style.display = "block";
}

function confirmVote(){
  if(!musicaSelecionada) return;

  const ref = database.ref("ranking/" + musicaSelecionada);
  ref.transaction(current => (current || 0) + 1);

  musicaSelecionada = null;

  document.getElementById("confirmScreen").style.display = "none";
  document.getElementById("voteScreen").style.display = "block";
}

function showRanking(){
  document.getElementById("voteScreen").style.display = "none";
  document.getElementById("rankingScreen").style.display = "block";
}

function backToVote(){
  document.getElementById("rankingScreen").style.display = "none";
  document.getElementById("voteScreen").style.display = "block";
}

// Ranking em tempo real
database.ref("ranking").on("value", snapshot => {
  const data = snapshot.val() || {};
  const sorted = Object.entries(data).sort((a,b)=>b[1]-a[1]);

  let html = "";
  sorted.forEach((item,index)=>{
    html += `<div class="rankItem">${index+1}º - ${item[0]} (${item[1]} votos)</div>`;
  });

  document.getElementById("rankingList").innerHTML = html;
});
</script>

</body>
</html>      transition: 0.2s;
    }

    button:hover {
      transform: scale(1.05);
    }

    .a { background: #e74c3c; color: white; }
    .b { background: #3498db; color: white; }
    .c { background: #2ecc71; color: white; }

    .ranking {
      margin-top: 40px;
      font-size: 22px;
    }

    .card {
      background: #222;
      padding: 10px;
      margin: 10px auto;
      width: 250px;
      border-radius: 8px;
    }
  </style>
</head>

<body>

  <h1>Vote na Melhor Opção</h1>

  <div class="buttons">
    <button class="a" onclick="vote('Opção A')">Opção A</button>
    <button class="b" onclick="vote('Opção B')">Opção B</button>
    <button class="c" onclick="vote('Opção C')">Opção C</button>
  </div>

  <div class="ranking">
    <h2>Ranking ao Vivo</h2>
    <div id="results"></div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCxpYTjgDElVqhhG-OUXJGIWXapifaZ9Zw",
      authDomain: "totem-12c8a.firebaseapp.com",
      databaseURL: "https://totem-12c8a-default-rtdb.firebaseio.com",
      projectId: "totem-12c8a",
      storageBucket: "totem-12c8a.appspot.com",
      messagingSenderId: "308642629645",
      appId: "1:308642629645:web:dfa6a4ce6dd85de4bced44"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    function vote(option) {
      const ref = database.ref("votes/" + option);
      ref.transaction(function(current) {
        return (current || 0) + 1;
      });
    }

    const resultsRef = database.ref("votes");

    resultsRef.on("value", function(snapshot) {
      const data = snapshot.val() || {};
      const sorted = Object.entries(data).sort((a, b) => b[1] - a[1]);

      let html = "";

      sorted.forEach(function(item, index) {
        html += `
          <div class="card">
            <strong>${index + 1}º</strong> - ${item[0]}<br>
            ${item[1]} votos
          </div>
        `;
      });

      document.getElementById("results").innerHTML = html;
    });
  </script>

</body>
</html>
button{
    padding:25px;
    font-size:18px;
    border:none;
    border-radius:12px;
    background:#e10600;
    color:white;
}

button:active{
    background:#ff3b30;
}

#confirmScreen{
    display:none;
    padding:40px;
}

#rankingScreen{
    display:none;
    padding:20px;
}

.big{
    font-size:28px;
    margin:20px 0;
}

.rankItem{
    font-size:22px;
    margin:10px 0;
}
</style>
</head>

<body>

<h1>Escolha a próxima música</h1>

<button class="topButton" onclick="abrirRanking()">
Ver Ranking ao Vivo
</button>

<div class="grid" id="musicGrid"></div>

<div id="confirmScreen">
    <div class="big" id="selectedMusic"></div>
    <button onclick="confirmVote()">Confirmar</button>
</div>

<div id="rankingScreen">
    <h1>Ranking de votos</h1>
    <div id="rankingList"></div>
    <button onclick="voltarParaGrid()">Voltar</button>
</div>

<script>

// Lista de músicas
const musicas = [
"Musica 1",
"Musica 2",
"Musica 3",
"Musica 4",
"Musica 5",
"Musica 6"
];

// Inicializa votos
let votos = {};
musicas.forEach(m => votos[m] = 0);

let escolhida = "";

const grid = document.getElementById("musicGrid");

// Cria botões
musicas.forEach(m => {
    const btn = document.createElement("button");
    btn.innerText = m;
    btn.onclick = () => escolher(m);
    grid.appendChild(btn);
});

function escolher(m){
    escolhida = m;
    document.querySelector(".grid").style.display="none";
    document.getElementById("confirmScreen").style.display="block";
    document.getElementById("selectedMusic").innerText = m;
}

function confirmVote(){
    votos[escolhida] += 1;
    showRanking();
    document.getElementById("confirmScreen").style.display="none";
    document.getElementById("rankingScreen").style.display="block";
}

function abrirRanking(){
    showRanking();
    document.querySelector(".grid").style.display="none";
    document.getElementById("confirmScreen").style.display="none";
    document.getElementById("rankingScreen").style.display="block";
}

// Mostra ranking
function showRanking(){
    const rankingDiv = document.getElementById("rankingList");
    rankingDiv.innerHTML = "";

    const sorted = Object.entries(votos)
        .sort((a,b) => b[1] - a[1]);

    sorted.forEach(([m,v]) => {
        const div = document.createElement("div");
        div.className="rankItem";
        div.innerText = `${m} — ${v} voto(s)`;
        rankingDiv.appendChild(div);
    });
}

function voltarParaGrid(){
    document.getElementById("rankingScreen").style.display="none";
    document.getElementById("confirmScreen").style.display="none";
    document.querySelector(".grid").style.display="grid";
}

</script>

</body>

</html>


