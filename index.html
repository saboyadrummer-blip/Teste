<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Totem de VotaÃ§Ã£o</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #141414;
  color: white;
  padding: 20px;
}

h1 { text-align:center; margin-bottom:20px; }

input {
  display:block;
  margin:0 auto 30px auto;
  width:90%;
  max-width:500px;
  padding:12px;
  font-size:18px;
  border-radius:6px;
  border:none;
}

.category { margin-bottom:40px; }

.category h2 {
  margin-left:10px;
  margin-bottom:15px;
  color:#e50914;
}

.grid {
  display:grid;
  grid-template-columns:repeat(auto-fill, minmax(200px,1fr));
  gap:15px;
}

.card {
  background:#222;
  padding:20px;
  border-radius:8px;
  cursor:pointer;
  transition:0.3s;
  text-align:center;
  font-size:14px;
}

.card:hover {
  transform:scale(1.05);
  background:#e50914;
}

#rankingList { margin-top:40px; text-align:center; }

.rankItem { font-size:20px; margin:5px 0; }

.top1 { color:gold; font-weight:bold; }
.top2 { color:silver; font-weight:bold; }
.top3 { color:#cd7f32; font-weight:bold; }

#message { text-align:center; margin-top:20px; color:#00ff88; }
#countdown { text-align:center; margin-top:10px; color:#ffdd00; }
</style>
</head>

<body>

<h1>Escolha a prÃ³xima mÃºsica</h1>
<input type="text" id="search" placeholder="ðŸ”Ž Buscar mÃºsica...">
<div id="content"></div>

<div id="message"></div>
<div id="countdown"></div>

<h2 style="text-align:center;margin-top:40px;">Ranking ao Vivo</h2>
<div id="rankingList"></div>

<script>
const firebaseConfig = {
  apiKey: "SUA_KEY",
  authDomain: "SUA_DOMAIN",
  databaseURL: "SUA_URL",
  projectId: "SUA_ID"
};

firebase.initializeApp(firebaseConfig);
const database = firebase.database();

const musicas = {

"Rock Internacional": [
"Nirvana â€“ Smells Like Teen Spirit",
"Nirvana â€“ Come As You Are",
"Nirvana â€“ Heart-Shaped Box",
"Nirvana â€“ About A Girl",
"Pearl Jam â€“ Soldier of Love",
"Pearl Jam â€“ Last Kiss",
"Pearl Jam â€“ Black",
"U2 â€“ With Or Without You",
"U2 â€“ Helter Skelter",
"Pink Floyd â€“ Wish You Were Here",
"Lynyrd Skynyrd â€“ Sweet Home Alabama",
"Lynyrd Skynyrd â€“ Simple Man",
"Foo Fighters â€“ Everlong",
"Radiohead â€“ Creep",
"The Police â€“ Roxanne",
"The Police â€“ Every Breath You Take",
"The Rolling Stones â€“ Anybody Seen My Baby?",
"Cream â€“ White Room",
"Cream â€“ Sunshine Of Your Love",
"INXS â€“ Never Tear Us Apart",
"INXS â€“ Need You Tonight",
"Led Zeppelin â€“ Immigrant Song",
"Led Zeppelin â€“ Rock And Roll",
"Queens of the Stone Age â€“ No One Knows",
"Queens of the Stone Age â€“ Make It Wit Chu",
"Queen â€“ Another One Bites The Dust",
"The Doors â€“ Roadhouse Blues",
"The Doors â€“ Love Me Two Times",
"The Doors â€“ Riders On The Storm",
"The White Stripes â€“ Seven Nation Army",
"Alice In Chains â€“ Man In The Box",
"Alice In Chains â€“ Would?",
"Alice In Chains â€“ Down In A Hole",
"Black Sabbath â€“ Paranoid",
"Stone Temple Pilots â€“ Plush",
"Stone Temple Pilots â€“ Interstate Love Song",
"Stone Temple Pilots â€“ Creep",
"Tom Petty â€“ Runnin' Down A Dream",
"Foghat â€“ Slow Ride",
"Survivor â€“ Eye Of The Tiger",
"Foreigner â€“ I Want To Know What Love Is",
"The Outfield â€“ Your Love",
"Blur â€“ Coffee & TV",
"Spin Doctors â€“ Two Princes",
"Lenny Kravitz â€“ It Ain't Over 'Til It's Over",
"Lenny Kravitz â€“ Fly Away",
"Oasis â€“ Wonderwall",
"Kings of Leon â€“ Closer",
"Green Day â€“ American Idiot",
"The Smashing Pumpkins â€“ 1979"
],

"Rock Nacional": [
"Os Paralamas do Sucesso â€“ Meu Erro",
"Skank â€“ Garota Nacional",
"Skank â€“ Sutilmente",
"LobÃ£o â€“ Me Chama",
"LobÃ£o â€“ BlÃ¡, BlÃ¡, BlÃ¡... Eu Te Amo",
"LobÃ£o â€“ RÃ¡dio BlÃ¡",
"BarÃ£o Vermelho â€“ Bete BalanÃ§o",
"Frejat â€“ Segredos",
"LegiÃ£o Urbana â€“ Pais E Filhos",
"Cazuza â€“ Exagerado",
"TitÃ£s â€“ Pra Dizer Adeus"
],

"ClÃ¡ssicos & Soul": [
"The Beatles â€“ Come Together",
"The Beatles â€“ Hey Jude",
"The Beatles â€“ Let It Be",
"Ben E. King â€“ Stand By Me",
"Elvis Presley â€“ Suspicious Minds",
"Eric Clapton â€“ Cocaine",
"Commodores â€“ Easy",
"Creedence Clearwater Revival â€“ Proud Mary",
"Creedence Clearwater Revival â€“ Have You Ever Seen The Rain",
"Creedence Clearwater Revival â€“ Suzie Q",
"Creedence Clearwater Revival â€“ Born On The Bayou",
"Creedence Clearwater Revival â€“ Bad Moon Rising",
"Creedence Clearwater Revival â€“ Fortunate Son"
],

"Pop & Outros": [
"Tim Maia â€“ Gostava Tanto de VocÃª",
"Tim Maia â€“ Primavera (Vai Chuva)",
"Djavan â€“ LilÃ¡s",
"Maroon 5 â€“ Sugar",
"Natalie Imbruglia â€“ Torn",
"Jimmy Cliff â€“ I Can See Clearly Now",
"Mike + The Mechanics â€“ Over My Shoulder",
"Sugar Ray â€“ Every Morning",
"Phil Collins â€“ I Don't Care Anymore",
"Modjo â€“ Lady"
]

};

const content = document.getElementById("content");
const searchInput = document.getElementById("search");
const message = document.getElementById("message");
const countdownDiv = document.getElementById("countdown");

let bloqueado = false;

function gerarGrid(filtro="") {
  content.innerHTML = "";

  Object.keys(musicas).forEach(categoria => {
    const filtradas = musicas[categoria].filter(m =>
      m.toLowerCase().includes(filtro.toLowerCase())
    );

    if(filtradas.length > 0) {

      const divCat = document.createElement("div");
      divCat.className = "category";

      const titulo = document.createElement("h2");
      titulo.innerText = categoria;
      divCat.appendChild(titulo);

      const grid = document.createElement("div");
      grid.className = "grid";

      filtradas.forEach(musica => {
        const card = document.createElement("div");
        card.className = "card";
        card.innerText = musica;

        card.onclick = function() {
          if(bloqueado) return;
          bloqueado = true;

          database.ref("ranking/" + musica)
            .transaction(current => (current || 0) + 1);

          message.innerText = "âœ… Voto computado!";

          let tempo = 5;
          countdownDiv.innerText = `â³ PrÃ³ximo voto em: ${tempo}s`;

          const interval = setInterval(() => {
            tempo--;
            if(tempo > 0){
              countdownDiv.innerText = `â³ PrÃ³ximo voto em: ${tempo}s`;
            } else {
              clearInterval(interval);
              bloqueado = false;
              countdownDiv.innerText = "";
              message.innerText = "";
            }
          }, 1000);
        };

        grid.appendChild(card);
      });

      divCat.appendChild(grid);
      content.appendChild(divCat);
    }
  });
}

gerarGrid();

searchInput.addEventListener("input", e => {
  gerarGrid(e.target.value);
});

database.ref("ranking").on("value", snapshot => {
  const data = snapshot.val() || {};
  const sorted = Object.entries(data).sort((a,b)=>b[1]-a[1]);

  let html = "";
  sorted.forEach((item,index)=>{
    let medal="",classe="";
    if(index===0){ medal="ðŸ¥‡ "; classe="top1"; }
    if(index===1){ medal="ðŸ¥ˆ "; classe="top2"; }
    if(index===2){ medal="ðŸ¥‰ "; classe="top3"; }

    html += `<div class="rankItem ${classe}">
    ${medal}${index+1}Âº - ${item[0]} (${item[1]} votos)
    </div>`;
  });

  document.getElementById("rankingList").innerHTML = html;
});
</script>

</body>
</html>
